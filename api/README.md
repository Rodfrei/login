# Ativide:
- Criar API com funcionalidades de: Criar conta, editar conta, login e obter dados do usuário logado.
- Criar tabela com os dados de usuários: id, nome, telefone, email, senha, foto (url), funcao (ADMIN, USER), criado am, atualizado em

## Funcionalidades
###Perfil
- Buscar dados do usuario: `GET /usuario`, buscar perfil do usuario logado.
- Editar perfil: `PUT /usuario/editar`, editar perfil do usuario logado.

###ADM
- Desabilitar perfil:`PUT /usuario/desabilitar/{id}`, id do usuario que se quer desabilitar o perfil. Somente o ADM tem acesso.

###Usuario
- Login: `POST /login`  
- Logout: `POST /logout`
- Incluir usuario: `POST /usuarios`

### Schema
```sql
DROP TABLE IF EXISTS permissao CASCADE;
DROP TABLE IF EXISTS usuario CASCADE;

CREATE TABLE usuario (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	nome VARCHAR(255) NOT NULL,
	email VARCHAR(255) NOT NULL,
	telefone VARCHAR(9),
	criado_em DATE NOT NULL,
	atualizado_em DATE NOT NULL,
	senha VARCHAR(128) NOT NULL,
	foto_perfil VARCHAR(512) NOT NULL,
	ativo BOOLEAN DEFAULT true
);
ALTER TABLE usuario ADD CONSTRAINT pk_usuario PRIMARY KEY (id);
ALTER TABLE usuario ADD CONSTRAINT uk_usuario_email UNIQUE (email);


CREATE TABLE permissao (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	funcao VARCHAR(100) NOT NULL,
	usuario_id BIGINT NOT NULL
);
ALTER TABLE permissao ADD CONSTRAINT pk_permissao PRIMARY KEY (id);
ALTER TABLE permissao ADD CONSTRAINT uk_permissao UNIQUE (funcao, usuario_id);
ALTER TABLE permissao ADD CONSTRAINT fk_permissao_usuario FOREIGN KEY (usuario_id) REFERENCES usuario;
```

### Inserts
```sql
INSERT INTO usuario (email, nome, telefone, criado_em, atualizado_em, foto_perfil, senha) 
VALUES 
('rodolfo@cwi.com.br', 'Rodolfo Reichert Schirmer Freitas', '123456789', '1997-03-18', '2022-03-01', 'https://i.pinimg.com/originals/55/2b/af/552bafe5dd51bbac1c9c763a5952b92c.jpg', '$2a$10$VrIbJURwINOR5HOrWFFTNOwSILsioRJSuOGAg8Luvr9qZDSOl5JXG'),
('maria@cwi.com.br', 'Maria da Silva', '111111111', '2000-07-25', '2019-03-08', 'https://i.pinimg.com/originals/55/2b/af/552bafe5dd51bbac1c9c763a5952b92c.jpg', '$2a$10$VrIbJURwINOR5HOrWFFTNOwSILsioRJSuOGAg8Luvr9qZDSOl5JXG'),
('joao@cwi.com.br', 'Joao da Silva', '777777777', '2007-07-25', '2015-03-08', 'https://i.pinimg.com/originals/55/2b/af/552bafe5dd51bbac1c9c763a5952b92c.jpg', '$2a$10$VrIbJURwINOR5HOrWFFTNOwSILsioRJSuOGAg8Luvr9qZDSOl5JXG'),
('pedro@cwi.com.br', 'Pedro da Silva', '987654321', '2005-03-28', '2021-03-08', 'https://i.pinimg.com/originals/55/2b/af/552bafe5dd51bbac1c9c763a5952b92c.jpg', '$2a$10$VrIbJURwINOR5HOrWFFTNOwSILsioRJSuOGAg8Luvr9qZDSOl5JXG');

insert into permissao (funcao, usuario_id) values ('USUARIO', 1);
insert into permissao (funcao, usuario_id) values ('USUARIO', 2);
insert into permissao (funcao, usuario_id) values ('USUARIO', 3);
insert into permissao (funcao, usuario_id) values ('ADMIN', 4);
```

##Rodar a aplicação
- 1 - Criar o banco de dados localmente;
- 2 - Executar os scripts SQL presentes na pasta data para iniciar a base de dados;
- 3 - Alterar as especificações do arquivo application.yml para sua base de dados;
- 4 - Iniciar a aplicação java no IntelliJ;
- 5 - Importar o arquivo Insomnia_end_points.json presente na pasta data no Insomnia ou Postman para efetuar testes.
  



## Dependências

- Java 11
- PostgreSQL 14
- Criar objetos de banco: `data/schema.sql`
- Carga inicial: `data/insert.sql`
- Arquivo do insomnia: `data/Insomnia_end_points.json`
